<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minimal Text</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
@font-face {
  font-family: 'PatrickHandLocal';
  src: url('fonts/PatrickHand-Regular.woff2') format('woff2');
  font-weight: normal;
  font-style: normal;
  font-display: block;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, sans-serif;
  background: #3b2f2f;
  color: #fff;
  display: flex;
  flex-direction: column;
  align-items: center;
}

#editor {
  width: 92%;
  max-width: 480px;
  min-height: 32vh;
  padding: 18px;
  font-size: 22px;
  line-height: 1.5;
  border: none;
  outline: none;
  resize: none;
  background: #bbf7d0;
  border-radius: 14px;
  margin-top: 14px;
  overflow: hidden;
}

#editor.bold { font-weight: bold; }
#editor.caps { text-transform: uppercase; }
#editor.important { box-shadow: 0 0 0 3px #ef4444 inset; }

.toolbar {
  width: 92%;
  max-width: 480px;
  display: flex;
  gap: 8px;
  margin: 10px 0;
}

.toolbar button {
  flex: 1;
  padding: 8px;
  border: none;
  border-radius: 10px;
  background: #4a3838;
  color: #fff;
  font-weight: 600;
}

.toolbar button.active {
  background: #2563eb;
}
</style>
</head>
<body>

<textarea id="editor" placeholder="Start typing..."></textarea>

<div class="toolbar">
  <button id="boldBtn">BOLD</button>
  <button id="capsBtn">CAPS</button>
  <button id="importantBtn">IMPORTANT</button>
  <button id="saveBtn">SAVE</button>
  <button id="shotBtn">SHOT</button>
</div>

<script>
const editor = document.getElementById("editor");
const boldBtn = document.getElementById("boldBtn");
const capsBtn = document.getElementById("capsBtn");
const importantBtn = document.getElementById("importantBtn");
const saveBtn = document.getElementById("saveBtn");
const shotBtn = document.getElementById("shotBtn");

function saveState() {
  localStorage.setItem("note", editor.value);
  localStorage.setItem("bold", editor.classList.contains("bold"));
  localStorage.setItem("caps", editor.classList.contains("caps"));
  localStorage.setItem("important", editor.classList.contains("important"));
}

function loadState() {
  editor.value = localStorage.getItem("note") || "";
  if (localStorage.getItem("bold") === "true") {
    editor.classList.add("bold");
    boldBtn.classList.add("active");
  }
  if (localStorage.getItem("caps") === "true") {
    editor.classList.add("caps");
    capsBtn.classList.add("active");
  }
  if (localStorage.getItem("important") === "true") {
    editor.classList.add("important");
    importantBtn.classList.add("active");
  }
}

boldBtn.onclick = () => {
  editor.classList.toggle("bold");
  boldBtn.classList.toggle("active");
  saveState();
};

capsBtn.onclick = () => {
  editor.classList.toggle("caps");
  capsBtn.classList.toggle("active");
  saveState();
};

importantBtn.onclick = () => {
  editor.classList.toggle("important");
  importantBtn.classList.toggle("active");
  saveState();
};

saveBtn.onclick = saveState;

shotBtn.onclick = async () => {
  await document.fonts.ready;

  const temp = document.createElement("div");
  temp.style.width = editor.offsetWidth + "px";
  temp.style.padding = "18px";
  temp.style.background = "#bbf7d0";
  temp.style.borderRadius = "14px";
  temp.style.fontSize = "22px";
  temp.style.lineHeight = "1.5";
  temp.style.fontFamily = "PatrickHandLocal";
  temp.style.whiteSpace = "pre-wrap";
  temp.style.color = "#3b2f2f";
  temp.style.fontWeight = editor.classList.contains("bold") ? "bold" : "normal";
  temp.style.textTransform = editor.classList.contains("caps") ? "uppercase" : "none";
  temp.textContent = editor.value;

  document.body.appendChild(temp);

  const canvas = await html2canvas(temp, { backgroundColor: null });

  const link = document.createElement("a");
  link.download = "note.png";
  link.href = canvas.toDataURL();
  link.click();

  document.body.removeChild(temp);
};

editor.addEventListener("input", saveState);

loadState();
</script>

</body>
</html>
