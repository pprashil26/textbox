<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Minimal Text</title>

<!-- PWA + Icons -->
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icon-512.png">
<link rel="apple-touch-icon" href="icon-512.png">
<meta name="theme-color" content="#3b2f2f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
  * { box-sizing: border-box; }

  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #3b2f2f;
    color: #000;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #editor {
    width: 92%;
    max-width: 480px;
    height: 32vh;
    padding: 18px;
    font-size: 22px;
    line-height: 1.5;
    border: none;
    outline: none;
    resize: none;
    background: #fff9c4;
    border-radius: 14px;
    margin-top: 14px;
  }

  #editor.bold { font-weight: bold; }
  #editor.caps { text-transform: uppercase; }

  .toolbar {
    width: 92%;
    max-width: 480px;
    display: flex;
    gap: 8px;
    margin: 10px 0 6px;
  }

  .toolbar button {
    flex: 1;
    padding: 8px 0;
    font-size: 14px;
    font-weight: 600;
    border: none;
    border-radius: 10px;
    background: #f1f3f5;
    color: #111;
  }

  .toolbar button.active {
    background: #2563eb;
    color: #fff;
  }

  .templates {
    width: 92%;
    max-width: 480px;
    margin-top: 10px;
  }

  .templates h3 {
    font-size: 14px;
    font-weight: 600;
    color: #ddd;
    margin-bottom: 6px;
  }

  .template-item {
    display: flex;
    gap: 6px;
    margin-bottom: 8px;
  }

  .template-item button.template-text {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 10px;
    background: #eef2ff;
    font-size: 15px;
    text-align: left;
  }

  .template-item button.delete {
    width: 36px;
    border: none;
    border-radius: 10px;
    background: #ef4444;
    color: #fff;
    font-size: 18px;
    font-weight: 600;
  }

  .templates .add {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: none;
    border-radius: 10px;
    background: #22c55e;
    color: #fff;
    font-weight: 600;
    text-align: center;
  }
</style>
</head>
<body>

<textarea id="editor" maxlength="160" placeholder="Type short messageâ€¦"></textarea>

<div class="toolbar" id="toolbar">
  <button id="boldBtn">B</button>
  <button id="capsBtn">CAPS</button>
  <button id="copyBtn">ðŸ“‹ Copy</button>
  <button id="clearBtn">ðŸ—‘ Clear</button>
  <button id="shotBtn">ðŸ“¸</button>
</div>

<div class="templates">
  <h3>Templates</h3>
  <button class="add" id="addTemplateBtn">+ Save current text as template</button>
  <div id="templateList"></div>
</div>

<script>
  const editor = document.getElementById('editor');
  const boldBtn = document.getElementById('boldBtn');
  const capsBtn = document.getElementById('capsBtn');
  const copyBtn = document.getElementById('copyBtn');
  const clearBtn = document.getElementById('clearBtn');
  const shotBtn = document.getElementById('shotBtn');
  const toolbar = document.getElementById('toolbar');

  const addTemplateBtn = document.getElementById('addTemplateBtn');
  const templateList = document.getElementById('templateList');

  let templates = JSON.parse(localStorage.getItem('templates') || '[]');

  function renderTemplates() {
    templateList.innerHTML = '';
    templates.forEach((text, index) => {
      const row = document.createElement('div');
      row.className = 'template-item';

      const textBtn = document.createElement('button');
      textBtn.className = 'template-text';
      textBtn.textContent = text;
      textBtn.onclick = () => editor.value = text;

      const delBtn = document.createElement('button');
      delBtn.className = 'delete';
      delBtn.textContent = 'Ã—';
      delBtn.onclick = () => {
        templates.splice(index, 1);
        localStorage.setItem('templates', JSON.stringify(templates));
        renderTemplates();
      };

      row.appendChild(textBtn);
      row.appendChild(delBtn);
      templateList.appendChild(row);
    });
  }
  renderTemplates();

  addTemplateBtn.onclick = () => {
    if (!editor.value.trim()) return;
    templates.unshift(editor.value.trim());
    templates = templates.slice(0, 10);
    localStorage.setItem('templates', JSON.stringify(templates));
    renderTemplates();
  };

  boldBtn.onclick = () => {
    editor.classList.toggle('bold');
    boldBtn.classList.toggle('active');
  };

  capsBtn.onclick = () => {
    editor.classList.toggle('caps');
    capsBtn.classList.toggle('active');
  };

  copyBtn.onclick = async () => {
    await navigator.clipboard.writeText(editor.value);
    copyBtn.textContent = 'âœ“ Copied';
    setTimeout(() => copyBtn.textContent = 'ðŸ“‹ Copy', 800);
  };

  clearBtn.onclick = () => {
    editor.value = '';
  };

  async function takeScreenshot() {
    toolbar.style.display = 'none';
    const canvas = await html2canvas(editor, { backgroundColor: null });
    canvas.toBlob(async blob => {
      const file = new File([blob], 'text.png', { type: 'image/png' });
      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({ files: [file] });
      } else {
        const link = document.createElement('a');
        link.download = 'text.png';
        link.href = URL.createObjectURL(file);
        link.click();
      }
      toolbar.style.display = 'flex';
    });
  }

  shotBtn.onclick = takeScreenshot;

  let twoFinger = false;
  document.addEventListener('touchstart', e => {
    if (e.touches.length === 2) twoFinger = true;
  });
  document.addEventListener('touchend', () => {
    if (twoFinger) {
      takeScreenshot();
      twoFinger = false;
    }
  });
</script>

</body>
</html>
