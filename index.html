<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minimal Text App</title>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: #ffffff;
    color: #000;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Top toolbar */
  .toolbar {
    display: flex;
    gap: 10px;
    margin: 14px 0;
  }

  .toolbar button {
    padding: 10px 16px;
    font-size: 15px;
    font-weight: 600;
    border: none;
    border-radius: 12px;
    background: #f1f3f5;
    color: #111;
  }

  .toolbar button.active {
    background: #2563eb; /* modern blue */
    color: #fff;
  }

  /* Editor */
  #editor {
    width: 92%;
    max-width: 480px;
    height: 32vh;
    padding: 18px;
    font-size: 22px;
    line-height: 1.5;
    border: none;
    outline: none;
    resize: none;
    background: #fff9c4;
    border-radius: 14px;
  }

  #editor.bold { font-weight: bold; }
  #editor.caps { text-transform: uppercase; }

  /* Templates section */
  .templates {
    width: 92%;
    max-width: 480px;
    margin-top: 14px;
  }

  .templates h3 {
    font-size: 14px;
    font-weight: 600;
    color: #555;
    margin-bottom: 6px;
  }

  .templates button {
    width: 100%;
    padding: 10px;
    margin-bottom: 8px;
    border: none;
    border-radius: 10px;
    background: #eef2ff;
    font-size: 15px;
    text-align: left;
  }

  .templates .add {
    background: #22c55e;
    color: #fff;
    font-weight: 600;
    text-align: center;
  }
</style>
</head>
<body>

<div class="toolbar" id="toolbar">
  <button id="boldBtn">B</button>
  <button id="capsBtn">CAPS</button>
  <button id="copyBtn">Copy</button>
  <button id="shotBtn">ðŸ“¸</button>
</div>

<textarea id="editor" maxlength="160" placeholder="Type short messageâ€¦"></textarea>

<div class="templates">
  <h3>Templates</h3>
  <button class="add" id="addTemplateBtn">+ Save current text as template</button>
  <div id="templateList"></div>
</div>

<script>
  const editor = document.getElementById('editor');
  const boldBtn = document.getElementById('boldBtn');
  const capsBtn = document.getElementById('capsBtn');
  const copyBtn = document.getElementById('copyBtn');
  const shotBtn = document.getElementById('shotBtn');
  const toolbar = document.getElementById('toolbar');

  const addTemplateBtn = document.getElementById('addTemplateBtn');
  const templateList = document.getElementById('templateList');

  let templates = JSON.parse(localStorage.getItem('templates') || '[]');

  function renderTemplates() {
    templateList.innerHTML = '';
    templates.forEach((text, i) => {
      const btn = document.createElement('button');
      btn.textContent = text;
      btn.onclick = () => editor.value = text;
      templateList.appendChild(btn);
    });
  }

  renderTemplates();

  addTemplateBtn.onclick = () => {
    if (!editor.value.trim()) return;
    templates.unshift(editor.value.trim());
    templates = templates.slice(0, 10); // keep it sane
    localStorage.setItem('templates', JSON.stringify(templates));
    renderTemplates();
  };

  boldBtn.onclick = () => {
    editor.classList.toggle('bold');
    boldBtn.classList.toggle('active');
  };

  capsBtn.onclick = () => {
    editor.classList.toggle('caps');
    capsBtn.classList.toggle('active');
  };

  copyBtn.onclick = async () => {
    await navigator.clipboard.writeText(editor.value);
    copyBtn.textContent = 'Copied';
    setTimeout(() => copyBtn.textContent = 'Copy', 800);
  };

  async function takeScreenshot() {
    toolbar.style.display = 'none';
    const canvas = await html2canvas(editor, { backgroundColor: null });
    canvas.toBlob(async blob => {
      const file = new File([blob], 'text.png', { type: 'image/png' });
      if (navigator.canShare && navigator.canShare({ files: [file] })) {
        await navigator.share({ files: [file] });
      } else {
        const link = document.createElement('a');
        link.download = 'text.png';
        link.href = URL.createObjectURL(file);
        link.click();
      }
      toolbar.style.display = 'flex';
    });
  }

  shotBtn.onclick = takeScreenshot;

  // âœŒï¸ 2-finger tap
  let twoFinger = false;
  document.addEventListener('touchstart', e => {
    if (e.touches.length === 2) twoFinger = true;
  });
  document.addEventListener('touchend', () => {
    if (twoFinger) {
      takeScreenshot();
      twoFinger = false;
    }
  });
</script>

</body>
</html>